# IR_wine

## Постановка задачи
Обучить нейросетевую модель предсказывать концентрации этанола (об.%), сахара (сахарозы+фруктозы, г/л), кислот (г/л), глицерина (г/л) и диоксида серы (г/л) в белых и красных винах.
Обучение модели проводится на данных спектроскопии ИК-поглощения растворов, моделирующих вина (См. п."Объекты исследования").
Такой подход позволяет экспериментально получить набор спектров ИК с известными концентрациями основных компонент вин для дальнейшего обучения нейронных сетей. 

![TOC](https://github.com/user-attachments/assets/a4b0c0a7-98c9-43d6-9350-8886728d04b0)


## Объекты исследования
1. Модельные растворы

В качестве модельных использовались водные растворы, содержащие **этанол**, смесь **глюкозы**, **фруктозы** и **сахарозы** (в соотношении 45:45:10), **винную**, **яблочную** и **лимонные кислоты** (в соотношении 40:40:20), глицерин и диоксид серы. Диапазоны изменения концентраций указанных компонентов в модельных растворах выбраны в соответствии с ГОСТ РФ 32030-2021 и приведены в Таблице 1. 

Модельные растворы были приготовлены из следующих базовых растворов в воде:

-- раствор этанола 60% (90 мл этанола + 60 мл воды),

--раствор сахара, 500 г/л (22.5 г глюкозы + 22.5 г фруктозы + 5 г сахарозы на 100 мл раствора),

раствор кислот, 250 г/л (2 г винной + 2 г яблочной + 1.094 г лимонной на 20 мл раствора),

-- раствор глицерина, 250 г/л (12.5 г на 50 мл раствора),

-- раствор SO<sub>2</sub>, 10 г/л (0.521 г соли K<sub>2</sub>S<sub>2</sub>O<sub>5</sub> на 30 мл раствора). 

Следует заметить, что в образце модельного вина, как и в реальных винах, всегда предполагается присутствие всех выбранных компонент (т.е. раствор всегда 5-компонентный). 
  
2. Образцы вина
  
  ![image](https://github.com/oesarmanova/IR_wine/assets/79655674/0118ec7c-04b2-45c7-bc75-08a433f564de)

Рис.1. Фотография образцов белых и красных вин.

## Приготовление модельных растворов

ТАБЛИЦА 1.

| Компонент  | Концентрации |
| ------------- | ------------- |
| Этанол (об.%)  | 8; 10; 12; 14; 18  |
| Сахар (г/л)  | 10; 25; 50; 100; 200  |
| Кислоты (г/л)  | 3; 6; 8; 10; 12  |
| Глицерин (г/л)  | 5; 10; 15; 20; 25 |
| Диоксид серы (г/л)  | 0.1; 0.2; 0.3; 0.5; 1  |

## Экспериментальное оборудование

### Измерение спектров ИК-поглощения модельных растворов

Измерения проводились на Фурье ИК спектрометре Bruker Invenio R в схеме НПВО (в режиме однократного отражения) в системе с прокачкой пробы и последующим промыванием системы водой. Спектры регистрировались в диапазоне 400-8000 см<sup>-1</sup> с шагом 2 см<sup>-1</sup>. При дальнейшей обработке спектров рассматривался диапазон 400 – 4000 см<sup>-1</sup>. Для каждого спектра делалось 16 сканов с водой в качестве фона в режиме измерения поглощения с атмосферной коррекцией. После регистрации спектра ИК каждой пробы система сначала продувалась воздухом и промывалась водой (примерно по 5-10 мл два раза), затем демонтировалась система прокачки, приборный столик последовательно протирался сухой салфеткой, спиртом, водой. Далее регистрировался спектр воды относительно ранее зарегистрированного фона для контроля качества промывки системы, затем спектр воды регистрировался в качестве фона. Далее в систему заливалась новая проба следующим образом: 1 мл пробы использовался для промывки системы, затем 1 мл пробы заливался в систему, его спектр ИК-поглощения измерялся.

![image](https://github.com/oesarmanova/IR_wine/assets/79655674/9c1ea92c-98f2-4bfe-8975-473b0f0c50c0)

Рис.2. ИК-Фурье спектрометр Bruker.

![Рисунок1](https://github.com/user-attachments/assets/53cbbf7d-1520-49de-a4d3-594eeaeccd5c)

Рис.3. Схема проведения измерений спектров ИК-поглощения в системе прокачки.

### Измерение концентраций компонентов модельных растворов с помощью аналитических методов.

В качестве независимого метода оценки концентрации сахара, этанола, органических кислот, глицерина и диоксида серы в реальных винах применялись газовая хроматография (ГХ) с парофазным анализом и высокоэффективная жидкостная хроматография (ВЭЖХ) с рефрактометрическим детектором. Измерения проводились в Испытательном Центре МГУ ЛАБ.
Содержание этанола и глицерина определялось ГХ. Содержание кислот – методом ВЭЖХ. Следует отметить, что полная диагностика даже 5 компонент вызвала сложности при измерениях химическими методами: потребовалось несколько различных методов с соответствующими приборами и несколько дней непосредственных измерений. 


## Набор данных

Исходный набор данных: 1734 примера

Набор данных после чистки: 1710 примеров 

Число признаков: 1868. Соответствуют диапазону 400 – 4000 смсм<sup>-1</sup>.

Количество целевых переменных: 5. Диапазоны изменения концентраций 5 компонентов соответствуют величинам, указанным в Таблице 1. 

### Удаление выбросов

Удаление выбросов происходило на основе анализа проекции набора данных в пространство первых трех главных компонент (анализ главных компонент) b поканальных статистических показателей массива данных (минимальное, максимально, медианное и среднее значение признака в спектральном канале).


До удаления выбросов:
![pca_raw](https://github.com/user-attachments/assets/13094570-4618-44f7-8d57-ebd602c930f3)

Проекция набора данных в пространство первых трех главных компонент до удаления выбросов.



После удаления выбросов:
![photo_2024-08-28_17-57-58](https://github.com/user-attachments/assets/7901fd35-e16d-440c-81d3-ff6452909945)

Проекция набора данных в пространство первых трех главных компонент после удаления выбросов.

![image](https://github.com/user-attachments/assets/9ce52229-1c2a-473c-9d31-5b50dd32774f)



### Реальные вина

## Спектроскопия ИК-поглощения 

### Модельные растворы
